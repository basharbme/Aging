---
title: "Hannum general markers analysis"
author: "Mikhail Dozmorov"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: html_document
---

```{r setup, echo=FALSE, include=FALSE, cache=FALSE}
# Set up the environment
library(knitr) 
opts_chunk$set(cache.path='cache/', fig.path='img/', cache=F, tidy=T, fig.keep='high', dpi=300,  echo=F, autodep=T, width=200, warning=FALSE, comment=NA, results='hide')
options(replace.assign=TRUE, width=500)
tidy.opts=list(width.cutoff=200)
suppressMessages(library(pander))
panderOptions('table.split.table', Inf)
set.seed(1)
```

```{r warning=FALSE, message=F}
source("../../R.GenomeRunner/utils.R")
```

Hannum markers: The 71 age-associated methylation regions included in the primary aging model
===
Chromatin states
---
Non-cell type-specific enrichment in 'Poised promoter' state, and depletion in 'Heterochromatin' state. Unadjusted p-values
```{r fig.height=5, eval=T}
showHeatmap("../GenomeRunner/Hannum/markers_vs_encBroadHmm/matrix.txt", colnum=2, factor="none", cell="none", isLog10=TRUE, adjust="none", pval=0.1, numtofilt=2, toPlot="heat")
```

```{r fig.height=3, eval=T}
showHeatmap("../GenomeRunner/Hannum/markers_vs_encBroadHmm/matrix.txt", colnum=2, factor="name", cell="none", isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=2, toPlot="bar")
```

Histone marks
---
H3K27me3 signature, H3K4me1/2/3, EZH2. Depletion in H3K36me3
```{r fig.height=5, eval=T}
showHeatmap("../GenomeRunner/Hannum/markers_vs_encHistone//matrix.txt", colnum=2, factor="Histone", cell="none", isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=3, toPlot="heat")
```

```{r fig.height=4, eval=T}
showHeatmap("../GenomeRunner/Hannum/markers_vs_encHistone//matrix.txt", colnum=2, factor="Histone", cell="none", isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=3, toPlot="bar")
```

TFBSs
---
Uncorrected p-values. Non-cell type-specific enrichment in CTCF and NRSF. Maybe, RAD21.
```{r fig.height=5, eval=T}
showHeatmap("../GenomeRunner/Hannum/markers_vs_encTfbs/matrix.txt", colnum=2, factor="Tfbs", cell="none", isLog10=TRUE, adjust="none", pval=1, numtofilt=12, toPlot="heat")
```

```{r fig.height=3, eval=T}
showHeatmap("../GenomeRunner/Hannum/markers_vs_encTfbs/matrix.txt", colnum=2, factor="Tfbs", cell="none", isLog10=TRUE, adjust="none", pval=0.1, numtofilt=1, toPlot="bar")
```

Hannum markers: The 89 age-associated methylation regions identified using all data.
===
Chromatin states
---
Non-cell type-specific enrichment in 'Poised promoter' state, and depletion in 'Heterochromatin' state.
```{r fig.height=5, eval=T}
showHeatmap("../GenomeRunner/Hannum/markers_vs_encBroadHmm/matrix.txt", colnum=1, factor="none", cell="none", isLog10=TRUE, adjust="none", pval=0.1, numtofilt=2, toPlot="heat")
```

```{r fig.height=3, eval=T}
showHeatmap("../GenomeRunner/Hannum/markers_vs_encBroadHmm/matrix.txt", colnum=1, factor="name", cell="none", isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=2, toPlot="bar")
```

Histone marks
---
H3K4me2 signature, H3K4me1/2/3, CTCF
```{r fig.height=5, eval=T}
showHeatmap("../GenomeRunner/Hannum/markers_vs_encHistone//matrix.txt", colnum=1, factor="Histone", cell="none", isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=3, toPlot="heat")
```

```{r fig.height=3, eval=T}
showHeatmap("../GenomeRunner/Hannum/markers_vs_encHistone//matrix.txt", colnum=1, factor="Histone", cell="none", isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=3, toPlot="bar")
```

TFBSs
---
Non-cell type-specific enrichment in CTCF. Depletion in Pol2 and TAF1
```{r fig.height=5, eval=T}
showHeatmap("../GenomeRunner/Hannum/markers_vs_encTfbs/matrix.txt", colnum=1, factor="Tfbs", cell="none", isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=3, toPlot="heat")
```

```{r fig.height=3, eval=T}
showHeatmap("../GenomeRunner/Hannum/markers_vs_encTfbs/matrix.txt", colnum=1, factor="Tfbs", cell="none", isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=2, toPlot="bar")
```



