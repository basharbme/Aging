---
title: "Hannum general markers analysis"
author: "Mikhail Dozmorov"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: html_document
---

```{r setup, echo=FALSE, include=FALSE, cache=FALSE}
# Set up the environment
library(knitr) 
opts_chunk$set(cache.path='cache/', fig.path='img/', cache=F, tidy=T, fig.keep='high', dpi=300,  echo=F, autodep=T, width=200, warning=FALSE, comment=NA, results='hide')
options(replace.assign=TRUE, width=500)
tidy.opts=list(width.cutoff=200)
suppressMessages(library(pander))
panderOptions('table.split.table', Inf)
set.seed(1)
```

```{r warning=FALSE, message=F}
source("../../R.GenomeRunner/utils.R")
cells=c("H1hesc", "Hsmm", "H1neurons", "H7es", "H9es")
```

Hannum tissue markers
===
    *  50 Hannum_aging_markers_breast.bed
    *  62 Hannum_aging_markers_kidney.bed
    *  14 Hannum_aging_markers_lung.bed
      
Chromatin states
---
Non-cell type-specific enrichment in 'Poised promoter' state, and depletion in 'Heterochromatin' state. Kidney also enriched in 'Repressed'

Breast is enriched in 'weak promoter'. All, kidney overwhelmingly stronger, are enriched in 'poised promoter'
Breast and kidney are depleted in 'weak Txn'. Kidney is strongly depleted in 'heterochromatin'.
```{r fig.height=3, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encBroadHmm/matrix.txt", colnum=c(1, 2, 3), factor="name", cell="none", isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=2, toPlot="bar")
```
```{r fig.height=3, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encBroadHmm/matrix.txt", colnum=c(1, 2, 3), factor="name", cell=cells, isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=2, toPlot="bar")
```

Breast
----
Global and specific enrichment in poised and weak promoter. 

Global depletion in heterochromatin. Specific depletion in weak Txn.
```{r fig.height=5, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encBroadHmm/matrix.txt", colnum=1, factor="none", cell="none", isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=2, toPlot="heat")
```
```{r fig.height=3, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encBroadHmm/matrix.txt", colnum=1, factor="name", cell="none", isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=2, toPlot="bar")
```
```{r fig.height=5, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encBroadHmm/matrix.txt", colnum=1, factor="none", cell=cells, isLog10=TRUE, adjust="fdr", pval=1, numtofilt=2, toPlot="heat")
```
```{r fig.height=3, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encBroadHmm/matrix.txt", colnum=1, factor="name", cell=cells, isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=2, toPlot="bar")
```

Kidney
----
Global and specific in poised promoter. In some cell lines, enriched in repressed. 

Global and specific depletion in heterochromatin, weak txn.
```{r fig.height=5, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encBroadHmm/matrix.txt", colnum=2, factor="none", cell="none", isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=2, toPlot="heat")
```
```{r fig.height=3, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encBroadHmm/matrix.txt", colnum=2, factor="name", cell="none", isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=2, toPlot="bar")
```
```{r fig.height=5, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encBroadHmm/matrix.txt", colnum=2, factor="none", cell=cells, isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=2, toPlot="heat")
```
```{r fig.height=3, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encBroadHmm/matrix.txt", colnum=2, factor="name", cell=cells, isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=2, toPlot="bar")
```

Lung
----

Weak enrichments. Global and specific poised promoter.
```{r fig.height=5, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encBroadHmm/matrix.txt", colnum=3, factor="none", cell="none", isLog10=TRUE, adjust="fdr", pval=1, numtofilt=2, toPlot="heat")
```
```{r fig.height=3, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encBroadHmm/matrix.txt", colnum=3, factor="name", cell="none", isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=2, toPlot="bar")
```
```{r fig.height=5, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encBroadHmm/matrix.txt", colnum=3, factor="none", cell=cells, isLog10=TRUE, adjust="fdr", pval=1, numtofilt=2, toPlot="heat")
```
```{r fig.height=3, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encBroadHmm/matrix.txt", colnum=3, factor="name", cell=cells, isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=2, toPlot="bar")
```

Histone marks
---

Breast and kidney enriched in H3K4me3, RBBP5, JMJD2A (transcriptional repressor). All, kidney most, are also enriched in H3K27me3.

Global and specific depletion in H3K36me3. Kidney and lung are depleted in H3K79me2, H3K27ac.
```{r fig.height=3, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encHistone/matrix.txt", colnum=c(1, 2, 3), factor="Histone", cell="none", isLog10=TRUE, adjust="none", pval=0.1, numtofilt=2, toPlot="bar")
```
```{r fig.height=3, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encHistone/matrix.txt", colnum=c(1, 2, 3), factor="Histone", cell=cells, isLog10=TRUE, adjust="none", pval=0.1, numtofilt=2, toPlot="bar")
```


Breast
---
Global and specific in H3K4me3, possibly H3K4me2 and CTCF. Depleted in H3K36me3, H4K20me1.
```{r fig.height=5, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encHistone/matrix.txt", colnum=1, factor="Histone", cell="none", isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=3, toPlot="heat")
```
```{r fig.height=3, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encHistone/matrix.txt", colnum=1, factor="Histone", cell="none", isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=2, toPlot="bar")
```
```{r fig.height=5, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encHistone/matrix.txt", colnum=1, factor="Histone", cell=cells, isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=3, toPlot="heat")
```
```{r fig.height=3, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encHistone/matrix.txt", colnum=1, factor="Histone", cell=cells, isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=2, toPlot="bar")
```


Kidney
---
Global and specific REST, H3K4me2, H3K27me3, EZH2. Depleted in H3K79me2. H3K36me3, H3K27ac.
```{r fig.height=5, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encHistone/matrix.txt", colnum=2, factor="Histone", cell="none", isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=4, toPlot="heat")
```
```{r fig.height=3, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encHistone/matrix.txt", colnum=2, factor="Histone", cell="none", isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=2, toPlot="bar")
```
```{r fig.height=5, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encHistone/matrix.txt", colnum=2, factor="Histone", cell=cells, isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=3, toPlot="heat")
```
```{r fig.height=3, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encHistone/matrix.txt", colnum=2, factor="Histone", cell=cells, isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=2, toPlot="bar")
```


Lung
---
H3K27me3, EZH2
```{r fig.height=5, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encHistone/matrix.txt", colnum=3, factor="Histone", cell="none", isLog10=TRUE, adjust="fdr", pval=0.3, numtofilt=2, toPlot="heat")
```
```{r fig.height=3, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encHistone/matrix.txt", colnum=3, factor="Histone", cell="none", isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=2, toPlot="bar")
```
```{r fig.height=5, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encHistone/matrix.txt", colnum=3, factor="Histone", cell=cells, isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=2, toPlot="heat")
```
```{r fig.height=3, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encHistone/matrix.txt", colnum=3, factor="Histone", cell="none", isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=2, toPlot="bar")
```

TFBSs
---

Breast, kidney - Znf143, SIN3A; Breast - CTCF; Kidney - Max, NRSF
```{r fig.height=3, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encTfbs/matrix.txt", colnum=c(1, 2, 3), factor="Tfbs", cell="none", isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=2, toPlot="bar")
```
```{r fig.height=3, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encTfbs/matrix.txt", colnum=c(1, 2, 3), factor="Tfbs", cell=cells, isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=2, toPlot="bar")
```


Breast
---
Znf143, CTCF, SIN3A, potentially, Max
```{r fig.height=5, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encTfbs/matrix.txt", colnum=1, factor="Tfbs", cell="none", isLog10=TRUE, adjust="fdr", pval=0.01, numtofilt=5, toPlot="heat")
```
```{r fig.height=3, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encTfbs/matrix.txt", colnum=1, factor="Tfbs", cell="none", isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=2, toPlot="bar")
```
```{r fig.height=5, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encTfbs/matrix.txt", colnum=1, factor="Tfbs", cell=cells, isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=3, toPlot="heat")
```
```{r fig.height=3, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encTfbs/matrix.txt", colnum=1, factor="Tfbs", cell=cells, isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=2, toPlot="bar")
```

Kidney
---
Max, Nrsf
```{r fig.height=5, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encTfbs/matrix.txt", colnum=2, factor="Tfbs", cell="none", isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=3, toPlot="heat")
```
```{r fig.height=3, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encTfbs/matrix.txt", colnum=2, factor="Tfbs", cell="none", isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=2, toPlot="bar")
```
```{r fig.height=5, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encTfbs/matrix.txt", colnum=2, factor="Tfbs", cell=cells, isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=3, toPlot="heat")
```
```{r fig.height=3, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encTfbs/matrix.txt", colnum=2, factor="Tfbs", cell=cells, isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=2, toPlot="bar")
```

Lung
---
NRSF, SIN3A
```{r fig.height=5, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encTfbs/matrix.txt", colnum=3, factor="Tfbs", cell="none", isLog10=TRUE, adjust="fdr", pval=0.4, numtofilt=2, toPlot="heat")
```
```{r fig.height=3, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encTfbs/matrix.txt", colnum=3, factor="Tfbs", cell="none", isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=2, toPlot="bar")
```
```{r fig.height=5, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encTfbs/matrix.txt", colnum=3, factor="Tfbs", cell=cells, isLog10=TRUE, adjust="fdr", pval=1, numtofilt=4, toPlot="heat")
```
```{r fig.height=3, eval=T}
showHeatmap("../GenomeRunner/Hannum/tissue_vs_encTfbs/matrix.txt", colnum=3, factor="Tfbs", cell=cells, isLog10=TRUE, adjust="fdr", pval=0.1, numtofilt=2, toPlot="bar")
```



